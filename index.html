<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Super Sales Chat Widget</title>
    <script>
        // Function to set environment and reload the page
        function toggleEnvironment() {
            const toggle = document.getElementById('envToggle');
            const isCloud = toggle.checked;
            const newEnvironment = isCloud ? 'cloud' : 'dev';

            // Save the selected environment in localStorage
            localStorage.setItem('environment', newEnvironment);

            // Set the correct API_URL based on the selected environment
            const apiUrl = isCloud
                ? "https://super-sales-api-smart-buy-jk7idose7a-uc.a.run.app"
                : "https://loving-massive-bull.ngrok-free.app";

            window.ChatWidgetConfig = {
                API_URL: apiUrl,
                TEAM_ID: "d9c6c9-2.myshopify.com",
                BOT_NAME: "StrykBot",
                THEME_SETTINGS: {
                    backgroundColor: 'black',
                    textColor: 'white',
                    secondaryTextColor: "grey",
                    headerText: "Our virtual assistant is here to help you.",
                    welcomeMessage: undefined,
                    textFont: "fantasy",
                    botAvatar: undefined
                }
            };

            // Reload the page
            location.reload();
        }

        function toggleDebug() {
            const debug = document.getElementById('debugToggle');
            const showDebug = debug.checked;

            window.ChatWidgetConfig = {
                ...window.ChatWidgetConfig,
                debug: showDebug
            };
            // Save the debug value in localStorage
            localStorage.setItem('debugLogs', showDebug);
            // Reload the page
            // location.reload();
        }

        const savedEnvironment = localStorage.getItem('environment') || 'dev';
        const apiUrl = savedEnvironment === 'cloud'
            ? "https://super-sales-api-smart-buy-jk7idose7a-uc.a.run.app"
            : "https://loving-massive-bull.ngrok-free.app";

        const savedDebug = localStorage.getItem('debugLogs') || false;


        window.ChatWidgetConfig = {
            API_URL: apiUrl,
            TEAM_ID: "d9c6c9-2.myshopify.com",
            ENV: "dev",
            BOT_NAME: "SmartBuy Bot",
            THEME_SETTINGS: {
                backgroundColor: 'black',
                textColor: 'white',
                secondaryTextColor: "grey",
                headerText: "Our virtual assistant is here to help you.",
                welcomeMessage: undefined,
                textFont: "fantasy",
                botAvatar: "https://raw.githubusercontent.com/urbullet/super-sales-demo/refs/heads/main/assets/robot.png"
            },
            debug: savedDebug
        };


        // Initialize the toggle based on saved environment
        window.onload = function () {
            const envToggle = document.getElementById('envToggle');
            const debugToggle = document.getElementById('debugToggle');

            // Set the toggle and API_URL based on saved environment
            envToggle.checked = savedEnvironment === 'cloud';
            debugToggle.checked = !!savedDebug;
        };
    </script>
    <script src="./super-sales-smartbuy-chatbot-bundle.js"></script>
    <style>
        .switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: #2196F3;
        }

        input:checked + .slider:before {
            transform: translateX(26px);
        }

        label {
            margin-left: 10px;
            font-family: Arial, sans-serif;
            font-size: 14px;
            color: black;
        }

        .toggle-container {
            margin: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .env-label {
            font-family: Arial, sans-serif;
            font-size: 14px;
        }
    </style>
</head>
<body>
<noscript>You need to enable JavaScript to run this app.</noscript>
<div id="root"></div>

<!-- Toggle for environment -->
<div class="toggle-container">
    <span class="env-label">Dev</span>
    <label class="switch">
        <input type="checkbox" id="envToggle" onclick="toggleEnvironment()">
        <span class="slider"></span>
    </label>
    <span class="env-label">Cloud</span>
</div>

<div class="toggle-container">
    <span class="env-label">Log </span>
    <label class="switch">
        <input type="checkbox" id="debugToggle" onclick="toggleDebug()">
        <span class="slider"></span>
    </label>
</div>
</body>
</html>
